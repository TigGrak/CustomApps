# CustomApps-jiejiari
**通过API获取当日节假日、纪念日、农历并用CustomApps推送**

[![](https://img.shields.io/badge/Author-TigGrak-orange.svg)](https://github.com/TigGrak)
![](https://img.shields.io/badge/version-v1.0-brightgreen.svg)

<br />

### [返回](https://github.com/TigGrak/CustomApps/) | CustomApps


<br />

## 配置
程序主要配置如下
| 字段 | 类型 | 选项 | 说明 |
| :----| :---- | :---- | :---- |
| push_url | str | url | 推送的url，例如 http://127.0.0.1:7000/api/v3/customapp |
| id | int | \ | CustomAppAPI的ID |
| mode | int | 0,1 | 查询模式，为1返回国际各类特殊纪念日信息 |
| updata | int | 0,1,2,3 | 更新类型，0为不更新，1为只更新程序，2为只更新jinfo，3为都更新 |
| key | str | \ | [天行数据节假日API](https://www.tianapi.com/apiview/139)的API Key |
| color | str(rgb) | rgb颜色值 | 默认推送文字的颜色，rgb形式，用英文逗号分隔，例如 67,142,219 |
| cuscolor | str(rgb) | rgb颜色值 | 默认自定义应用推送文字的颜色，rgb形式，用英文逗号分隔，例如 67,142,219 |
| color_priority | int | 0,1 | API的节假日与自定义节假日重叠时的颜色优先级，1为取API节假日的颜色，0为取自定义节假日的颜色 |
| icon_priority | int | 0,1 | API的节假日与自定义节假日重叠时的图标优先级，1为取API节假日的图标，0为取自定义节假日的图标 |

<br />

使用awtrix-push进行托管时的必要配置
> [JIEJIARI]下

| 字段 | 类型 | 选项 | 说明 |
| :----| :---- | :---- | :---- |
| crontab | bool | True,False | Crontab时间表，True 为启用，使用此项需设置好时间，与 seconds 冲突 |
| seconds | int | 秒速 | 每次执行此任务的间隔，秒为单位，与 crontab 冲突|

<br />

因此，在python中，你可以这么写：
```python
config = {'key':'XXXXXXXXXX','mode':'1','color':'67,142,219','cuscolor':'67,142,219',"push_url":"http://127.0.0.1:7000/api/v3/customapp","id":"2","updata":"3","color_priority":"1","icon_priority":"0"}
```

<br />

在awtrix-push的配置文件中，你可以这么写：

```ini
[JIEJIARI]
push_url=http://127.0.0.1:7000/api/v3/customapp
# 10min执行一次   或者crontab=True
seconds=600
id=2
mode=1
updata=3
key=XXXXXXXXXXXXXXXXXX
color=67,142,219
cuscolor=67,142,219
color_priority=1
icon_priority=0
```


<br />
<br />
<br />

## 文件
> 在初次执行jiejiari任务时，程序会自动在托管程序的目录下创建一个名为 `jiejiari` 的文件夹，里面存储着程序的运行所需的文件，可能有以下文件



| 文件名 | 说明 | 必要性 |
| :----| :---- |  :---- |
| %Y-%m.json | 从API读取的节假日信息文件,由程序更新 | 必须 |
| jinfo.json | 自定义从 %Y-%m.json 获取的节日的英文名、文字颜色和图标，可由程序创建或更新，或自己更改 | 可选 |
| customday.json | 自定义节假日的配置文件，由自己创建，更改。 | 可选 |
| error.txt | 错误日志。程序在获取、下载更新时遇到错误时创建或修改 | 可选 |
| jiejiari-version.py | 最新的程序，当程序的检查更新开启时且获取到新版本时自动下载 | 可选 |

<br />
<br />
<br />

## 自定义API节日、纪念日图标
> **_遇到个位数日期一定要补0，例如:<br />6.7   (×)<br />06.07   (√)_**

你可以通过修改 `jinfo.json` 来自定义API节日的英文名图标和文字颜色

> <svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="63" height="63" style='float:left'><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#1afa29" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#1afa29" p-id="1533"></path></svg> 作者衷心希望你能够将自己设计的节日图标、文字颜色或是修改过后的 `jinfo.json` 发送到 `tiggrak@163.com` 作者会将部分自定义API节日的图标和文字颜色上传至云端供大家使用。同时，你将会进入本markdown的感谢名单内。感谢你为此项目的付出！

文件结构：




```json
{
	"version":"1.0.0", //版本号，必填，自动更新时需要（如开启jinfo的自动更新）
	"jiejiari": {
		"节日、纪念日中文名": ["English name", "图标ID", "rgb颜色（列表形式）"], //用逗号分隔
        "示范": ["example","1",[255,255,255]]
        }
}
```



> **<svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="65" height="65" style='float:left' ><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#d81e06" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#d81e06" p-id="1533"></path></svg>　_如直接复制请删除注释！！!_<br />　_如直接复制请删除注释！！!_<br />　_如直接复制请删除注释！！!_**

<br />

> **<svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="20" height="20" style='float:left' ><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#d81e06" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#d81e06" p-id="1533"></path></svg>_文件格式、语法错误可能会导致程序崩溃（删除注释），请注意！！!_**

> 程序会自动识别该节日对应的英文名，图标，颜色，不需要重新启动程序（热修改）。

> 如果没有 `jinfo.json` 或程序找不到对应的颜色和图标ID，程序将会推送默认图标（不可修改）和默认颜色（可修改）。

> 天行数据API会提供部分节假日、纪念日的英文名，如果某节假日、纪念日没有英文名，程序将在 `jinfo.json` 中寻找，如没有 `jinfo.json` 文件或寻找不到，程序将不予推送。


<br />
<br />
<br />

## 自定义节日、纪念日

你可以通过创建修改 `jinfo.json` 来自定义节日和节日的英文名图标和文字颜色

> **_程序不会自动创建 `customday.json` ，你需要手动创建。_**

> **_遇到个位数日期一定要补0，例如:<br />6.7   (×)<br />06.07   (√)_**

文件结构：
```json
{
    "info":"BY TigGrak", //文件信息，可随意填写（不要破坏json语法）
    "jiejiari":{
        "日期(月-日)":["jieri english name","图标ID","rgb颜色（列表形式）"],
        //示范
        "06-10": ["example","1",[255,255,255]]

        }
}
```
> **<svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="65" height="65" style='float:left' ><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#d81e06" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#d81e06" p-id="1533"></path></svg>　_如直接复制请删除注释！！!_<br />　_如直接复制请删除注释！！!_<br />　_如直接复制请删除注释！！!_**

<br />

> **<svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="20" height="20" style='float:left' ><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#d81e06" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#d81e06" p-id="1533"></path></svg>_文件格式、语法错误可能会导致程序崩溃（删除注释），请注意！！!_**

> 程序会自动识别自定义节日，图标，颜色，不需要重新启动程序（热修改）。


<br />
<br />
<br />

## 其他

[天行数据](https://www.tianapi.com/)

[天行数据节假日API](https://www.tianapi.com/apiview/139)

使用的外部资源：

svg：
| 资源 | 来源\作者 |
| :--- | :--- |
|<svg t="1658307781339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1531" width="15" height="15" ><path d="M511.7 1024c-65.6 0-129.6-12.3-190.2-36.6-61.4-24.6-116.9-60.5-164.8-106.7C108.9 834.6 71 780.6 44.1 720.1 16.2 657.5 1.4 590.7 0.1 521.6c-1.3-69.1 11-136.4 36.5-200 24.6-61.4 60.5-116.9 106.7-164.8C189.4 108.9 243.4 71 303.9 44.1 366.5 16.2 433.3 1.4 502.4 0.1c69.1-1.3 136.4 11 200 36.5 61.4 24.6 116.9 60.5 164.8 106.7C915.1 189.4 953 243.5 979.9 304c27.9 62.6 42.7 129.4 44 198.5 1.3 69.1-11 136.4-36.5 200-24.6 61.4-60.5 116.9-106.7 164.8C834.6 915.2 780.5 953.1 720 980c-62.6 27.9-129.4 42.7-198.5 44h-9.8z m0.6-969.1c-2.9 0-5.9 0-8.8 0.1-61.7 1.2-121.3 14.4-177.2 39.2-54 24-102.2 57.9-143.4 100.7-41.2 42.8-73.2 92.3-95.2 147.1C64.8 398.8 53.9 458.8 55 520.6c1.2 61.7 14.4 121.3 39.2 177.2 24 54 57.9 102.2 100.7 143.4 42.8 41.2 92.3 73.2 147.1 95.2 56.8 22.8 116.8 33.7 178.5 32.6 61.7-1.2 121.3-14.4 177.2-39.2 54-24 102.2-57.9 143.4-100.7 41.2-42.8 73.2-92.3 95.2-147.1 22.8-56.8 33.7-116.8 32.6-178.5-1.2-61.7-14.4-121.3-39.2-177.2-24-54-57.9-102.2-100.7-143.4-42.8-41.2-92.3-73.2-147.1-95.2-54-21.8-111-32.8-169.6-32.8z" fill="#1afa29" p-id="1532"></path><path d="M512 793.3c-5.5 0-10.3-0.8-15-2.4-4.7-2.4-9.5-5.5-12.6-8.6-4-4-7.1-7.9-8.7-12.6-2.4-4.8-3.2-10.2-3.2-15.8 0-10.2 3.9-20.5 11.8-27.6 14.2-14.9 40.1-14.9 55.1 0 7.9 7.2 11.8 17.4 11.8 27.6 0 5.5-0.8 11-3.2 15.8-1.6 4.7-4.7 8.6-8.7 12.6-6.8 7.1-17 11-27.3 11z m0-173.1c-15.2 0-27.5-12.3-27.5-27.5v-323c0-15.2 12.3-27.5 27.5-27.5s27.5 12.3 27.5 27.5v323c0 15.2-12.3 27.5-27.5 27.5z" fill="#1afa29" p-id="1533"></path></svg> | [十个流年](https://www.iconfont.cn/user/detail?uid=56955&nid=bVFEvZlvlgxD)


